from utils import Utils

plaintext = "sell my car and send me the money"
cypherText = "9692306506281802743567399297011743077466106904132 319183574525285095355947880942312149614847500301740360942942 373270878482048298738041759034304471920213217908731516059557 162633336424180466554114072494334439863969106696433904481647 376601577167091869925941783269833504466726337709799066975604 151859525214403471448198541742070660642960126699571368936881".split(" ")
p = 588556073069635651905528453169
q = 666749047938382702503498353041
# p = 524287
# q = 6700417
n = p * q
d = 95799891326643709369395710719241970879267464936040001403959 - 10000000

# p1 = 588556073069635651905528453169
# q1 = 666749047938382702503498353041
# e1 = 6454649479
# 2294703617833
decyptedMsg = Utils.decryptMessage(cypherText, d,n)
decodedMsg = Utils.decodeMessage(decyptedMsg)
print(decodedMsg)
print("Breaking key...")
while decodedMsg.strip() != plaintext:
    decyptedMsg = Utils.decryptMessage(cypherText, d,n)
    decodedMsg = Utils.decodeMessage(decyptedMsg)
    d = d + 1
    print("d = " + str(d))
    # print(decodedMsg)
print("Key broken successfully")
print("d = " + str(d))
print("Exiting...")
    